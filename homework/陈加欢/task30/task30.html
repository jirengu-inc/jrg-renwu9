<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>task29-demo2</title>
	<style type="text/css">
		.ct{
			position: relative;
		}
		.item{
			position: absolute;
			width: 200px;
			margin:10px;
			transition: all 1s;
		}	
		.h1{
			height:300px;
			background: #b5e61d;
		}
		.h2{
			height:500px;
			background: #99d9ea;
		}
		.h3{
			height:400px;
			background: #c8bfe7;
		}

		.h4{
			height:200px;
			background: #ff7f27;
		}


	</style>
</head>
<body>
	<div class="ct">
		<div class="item h1">1</div>
		<div class="item h2">2</div>
		<div class="item h3">3</div>
		<div class="item h4">4</div>
		<div class="item h2">5</div>
		<div class="item h1">6</div>
		<div class="item h3">7</div>
		<div class="item h4">8</div>
		<div class="item h1">9</div>
		<div class="item h2">10</div>
		<div class="item h3">11</div>
		<div class="item h1">12</div>
		<div class="item h2">13</div>
		<div class="item h1">14</div>
		<div class="item h3">15</div>
		<div class="item h4">16</div>
		<div class="item h1">17</div>
		<div class="item h3">18</div>
		<div class="item h3">19</div>
		<div class="item h4">20</div>
		<div class="item h2">21</div>
		<div class="item h2">22</div>
		<div class="item h3">23</div>
		<div class="item h4">24</div>
	</div>


	
	<script type="text/javascript" src="http://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
	<script type="text/javascript">

		//方法一，最原始的写法

		function render(){
			var winW=$(window).width(),
			colW=$(".item").outerWidth(true),
			colNum=parseInt(winW/colW);

			var colSumHeight=[];
			for(var i=0; i<colNum; i++){
				colSumHeight[i]=0;
			}

			$(".item").each(function(){
				var idx=0;
				for(var i=0; i<colNum; i++){
					if(colSumHeight[i]<colSumHeight[idx]){
						idx=i;
					}
				}
				$(this).css({
					left:colW*idx,
					top:colSumHeight[idx]
				})
				colSumHeight[idx]=colSumHeight[idx]+$(this).outerHeight(true);
			})
		
		}
		render();

		$(window).on("resize",function(){
			render();
		})


		 //方法2， 闭包封装


 		// var water = (function($){

	 	// 	function render(){
		 //  		var nodeWidth = $('.item').outerWidth(true),
		 // 			colNum = parseInt($(window).width()/nodeWidth),
		 // 			colSumHeight = [];
		 // 		for(var i = 0; i<colNum;i++){
		 // 			colSumHeight.push(0);
		 // 		}
		 // 		$('.item').each(function(){
		 // 			var $cur = $(this);
		 // 			var idx = 0,
		 // 			minSumHeight = colSumHeight[0];

		 // 		for(var i=0;i<colSumHeight.length; i++){
		 // 			if(colSumHeight[i] < minSumHeight){
		 // 				idx = i;
		 // 				minSumHeight = colSumHeight[i];
		 // 			}
		 // 		}

		 // 		$cur.css({
		 // 			left: nodeWidth*idx,
		 // 			top: minSumHeight
		 // 		});
		 // 		colSumHeight[idx] = $cur.outerHeight(true) + colSumHeight[idx];
		 // 		});
	 	// 	}

	 	// 	$(window).on('resize', function(){
	 	// 		render();
	 	// 	})

 		// 	return {
 		// 		init: render
 		// 	}
 		// })(jQuery)

 		// water.init();



		
		

		
	</script>
</body>
</html>